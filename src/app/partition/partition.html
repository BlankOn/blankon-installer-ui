<div class="row">
  <div class="columns content">
      <h1>{{title}} <small ng-show="advancedPartition">Partition Editor</small></h1>
    <p ng-hide="devices[0]" class="fade">Please wait while your sistem is being scanned... </p>
    <p ng-show="devices[0] && !advancedPartition" class="fade"><a class="button dropdown" dropdown-toggle="#drive-selection"><span ng-show="!selectedDrive">Select drive...</span><span ng-show="selectedDrive">{{selectedDrive.path}} - {{selectedDrive.model}}</span></a><p>
    <ul id="drive-selection" class="f-dropdown">
      <li ng-repeat="drive in devices">
      <a ng-click="setDrive(drive)">{{drive.path}} - {{drive.model}} </a>
      </li>
    </ul>
    <div ng-hide="advancedPartition" class="fade">
      <p ng-show="selectedDrive" class="fade">Please choose the partition on device below which you would like to install BlankOn into or use advanced partitioning tool for more control.<br>
      </p>
      <div class="top-bar-partition" style="width:{{selectedDrive.driveWidth}}px" ng-show="selectedDrive" class="fade">
        <span class="legend-partition-normal">Used</span>
        <span class="legend-partition-disallow">Too small</span>
        <span class="legend-partition-freespace">Free space</span>
        <a class="button tiny right" ng-click="switchToAdvancedPartition()">Enter Advanced Mode</button>
</div>

      <div class="drive-block fade" ng-show="selectedDrive" style="width:{{selectedDrive.driveWidth}}px !important;">
        <a href="" ng-repeat="partition in selectedDrive.partitionList" ng-hide="partition.hidden" class="partition-block" ng-click="selectInstallationTarget(partition)" ng-class="{selected:partition.selected, disallow:partition.disallow, freespace:partition.freespace, normal:partition.normal, extended:partition.extended}">
          <span class="pop fade" style="color:white">
           Size : {{partition.sizeGb}} GB<br>
           File System : {{partition.filesystem || "-"}}<br>
           {{partition.description}}
          </span>
          <div style="width:{{partition.blockWidth}}px;">
          </div>
        </a>
      </div>
      <div ng-show="validInstallationTarget">
        <br>
        <p>
        You are choosing {{selectedInstallationTarget}} to be installed with BlankOn.<br>
        <strong>WARNING : </strong>
      The selected partition will be wiped out. Swap partition will be created if you don't have one.
      </p>
      </div>
    </div>
    <div ng-show="advancedPartition && !actionDialog" class="fade">
      <div class="top-bar-partition" style="width:{{selectedDrive.driveWidth}}px">
        <span ng-show="selectedDrive" class="legend-partition-primary">Primary</span>
        <span ng-show="selectedDrive" class="legend-partition-logical">Logical</span>
        <span ng-show="selectedDrive" class="legend-partition-freespace">Free space</span>
        <span ng-hide="exitAdvancedModeMessage || applyAdvancedModeMessage">
          <a class="button tiny right" ng-click="partitionApply()"><span >Apply</span></a>
          <a class="button tiny right" ng-click="redo()"><span >Redo</span></a>
          <a class="button tiny right" ng-click="undo()"><span >Undo</span></a>
          <a class="button tiny right" ng-click="switchToSimplePartitionWarning()"><span >Exit Advanced Mode</span></a>
        </span>
      </div>
      <div class="drive-block" ng-show="selectedDrive" style="width:{{selectedDrive.driveWidth}}px !important;">
        <div ng-repeat="partition in selectedDrive.partitionList"><a href=""  ng-hide="partition.hidden" class="partition-block" ng-class="{selected:(partition.selected || partition.highlighted), freespace:partition.freespace, primary:partition.normal, extended:partition.extended, logical:partition.logical}" ng-mouseover="highlight(partition)" ng-mouseleave="unhighlight(partition)">
          <div style="width:{{partition.blockWidth}}px;">
          </div>
        </a>
      </div>
      </div>
      <div ng-show="exitAdvancedModeMessage" class="fade">
        <p><br>
          Are you sure you want to exit Advanced Mode?<br>If yes, any step in PartoEdi will be aborted.
        </p>
        <button class="button" ng-click="hidePartoEdiMessage()">No</button>
        <button class="button" ng-click="switchToSimplePartition()">Yes</button>
      </div>
      <div ng-show="applyAdvancedModeMessage" class="fade">
        <p>
          <br>
          There should be at least one partition set up as root filesystem.
        </p>
        <button class="button" ng-click="hidePartoEdiMessage()">OK</button>
      </div>
      <table style="margin-top:10px;width:{{selectedDrive.driveWidth}}px" ng-hide="exitAdvancedModeMessage || applyAdvancedModeMessage">
              <tr>
                <td>Partition</td>
                <td>File System</td>
                <td>Mount Point</td>
                <td>Size</td>
                <td width="100"></td>
                <!--td>Used</td>
                <td>Unused</td-->
              </tr>
              <tr ng-repeat="partition in selectedDrive.partitionList" ng-hide="partition.hidden" ng-class="{highlight:partition.highlighted}" ng-mouseover="highlight(partition)" ng-mouseleave="unhighlight(partition)">
                <td class="td-partition">
                  <span ng-show="partition.logical || partition.logicalFreespace">&nbsp;&nbsp;&nbsp;</span>
                  <span ng-show="partition.id > 0 && !partition.new">
                    {{selectedDrive.path}}{{partition.id}}</span>
                  <span ng-show="partition.new">
                    New Partition</span>
                  <span ng-show="partition.id < 0 && !partition.new">Unallocated</span>
                </td>
                <td class="td-partition">
                  <span ng-show="partition.id > 0 && !partition.format">{{partition.filesystem}} </span>
                  <span ng-show="partition.extended">Extended</span>
                  <span class="td-partition" ng-show="(partition.id > 0 || partition.new) && partition.format && partition.mountPoint != 'swap'">Format as ext4</span>
                  <span class="td-partition" ng-show="partition.mountPoint == 'swap'">Linux swap</span>
                  <span class="td-partition" ng-show="partition.id < 0 && !partition.new">-</span>
                </td>

                <td class="td-partition"><span ng-hide="partition.extended">{{partition.mountPoint || '-'}}</span></td>
                <td class="td-partition"><span ng-hide="partition.extended">{{partition.sizeGb}} GB</td>
                <td class="td-partition" ng-show="partition.freespace && !partition.extended">
                   <a class="button tiny partoedi-button" ng-click="partitionCreate(partition)"><span >Create</span></a>
                </td>
                <td class="td-partition" ng-show="!partition.hasChild && partition.extended && !partition.new">
                   <a class="button tiny partoedi-button" ng-click="partitionDelete(partition)"><span >Delete</span></a>
                </td>
                <td class="td-partition" ng-show="partition.id > 0 && !partition.new && !partition.format && !partition.extended && !partition.mountPoint">
                   <a class="button tiny dropdown partoedi-button" dropdown-toggle="#action-{{partition.size}}" ng-hide="partition.extended"><span >Action</span></a>
                   <ul id="action-{{partition.size}}" class="f-dropdown" ng-show="partition.id > 0">
                     <li>
                      <a ng-click="partitionDelete(partition)">Delete</a>
                     </li>
                     <li>
                      <a ng-click="partitionFormat(partition)">Format</a>
                     </li>
                     <li ng-show="(partition.filesystem == 'ext3' || partition.filesystem == 'ext4' || partition.filesystem == 'xfs') && !partitionState.mountPoint.home">
                      <a ng-click="partitionMountAsHome(partition)">Use as /home</a>
                     </li>
                   </ul>
                </td>
              </tr>
      </table>
    </div>
    <div ng-show="formatDialog" class="fade">
      <h2>Format Partition</h2>
      <p>{{formatDialogSelected.sizeGbOrigin}} GB size ({{formatDialogSelected.start}} - {{formatDialogSelected.end}})</p>
      <div class="partoedi-action-dialog-form">
        <div class="row small-8">
          <div class="small-4 columns">
            <label class="right inline">Mount point</label>
          </div>
          <div class="small-8 columns">
            <select ng-model="formatDialogSelected.mountPoint">
              <option value="-" selected>Without mount point</option>
              <option ng-hide="partitionState.mountPoint.root" value="/">/</option>
              <option ng-hide="partitionState.mountPoint.home" value="/home">/home</option>
              <option value="swap">use as Swap</option>
            </select>
          </div>
        </div>
        <div>
          <p ng-show="formatDialogSelected.mountPoint=='-' || formatDialogSelected.mountPoint=='/' || formatDialogSelected.mountPoint=='/home'">This will be formatted as ext4 filesystem.</p>
          <p ng-show="formatDialogSelected.mountPoint=='swap'">This will be formatted as swap filesystem.</p>
        </div>
      </div>
      <div>
        <button class='button' ng-click="partitionFormatCancel()">Cancel</button>
        <button class='button' ng-click="partitionFormatApply(formatDialogSelected)">Apply</button>
      </div>
    </div>
    <div ng-show="createDialog" class="fade">
      <h2>Create Partition</h2>
      <p>{{createDialogSelected.sizeGbOrigin}} GB available ({{createDialogSelected.start}} - {{createDialogSelected.end}})</p>
      <div style="height:75px">
      <input ng-model="createSliderValue"  type="text" id="createSlider" slider options="createSliderOptions"/>
      </div>
      <div class="partoedi-action-dialog-form">
        <div class="row small-8">
          <div class="small-4 columns">
            <label class="right inline">New Size</label>
          </div>
          <div class="small-8 columns">
            <input type="text" value="{{createDialogSelected.sizeGb}} GB" disabled>
          </div>
        </div>
        <div class="row small-8" ng-hide="createDialogSelected.logicalFreespace">
          <div class="small-4 columns">
            <label class="right inline">Partition Type</label>
          </div>
          <div class="small-8 columns">
            <select ng-model="createDialogSelected.type">
              <option value="DEVICE_PARTITION_TYPE_NORMAL">Primary</option>
              <option value="DEVICE_PARTITION_TYPE_EXTENDED">Extended</option>
            </select>
          </div>
        </div>
        <div class="row small-8" ng-show="createDialogSelected.type=='DEVICE_PARTITION_TYPE_NORMAL' || createDialogSelected.logicalFreespace">
          <div class="small-4 columns">
            <label class="right inline">Mount point</label>
          </div>
          <div class="small-8 columns">
            <select ng-model="createDialogSelected.mountPoint">
              <option value="-" selected>Without mount point</option>
              <option ng-hide="partitionState.mountPoint.root" value="/">/</option>
              <option ng-hide="partitionState.mountPoint.home" value="/home">/home</option>
              <option value="swap">use as Swap</option>
            </select>
          </div>
        </div>
        <div ng-show="createDialogSelected.type=='DEVICE_PARTITION_TYPE_NORMAL' || createDialogSelected.logicalFreespace">
          <p ng-show="(createDialogSelected.mountPoint=='-' || createDialogSelected.mountPoint=='/' || createDialogSelected.mountPoint=='/home') && createDialogSelected.type=='DEVICE_PARTITION_TYPE_NORMAL'">This will be formatted as ext4 filesystem.</p>
          <p ng-show="createDialogSelected.mountPoint=='swap'">This will be formatted as swap filesystem.</p>
        </div>
      </div>
      <div>
        <button class='button' ng-click="partitionCreateCancel()">Cancel</button>
        <button class='button' ng-click="partitionCreateApply(createDialogSelected)">Apply</button>
      </div>

    </div>
  </div>
  <div class="columns nav-button" ng-show="devices[0] && !actionDialog && !advancedPartition">
    <button class='button' ng-click="previous()">Previous</button>
    <button class="button" ng-class="{disabled:!validInstallationTarget}" ng-click="partitionSimpleNext()">Next</button>
  </div>
</div>
